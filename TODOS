# Zynq 7z020 自定义镜像 vs 官方镜像 关键错误对比表
| 序号 | 启动阶段 | 错误项 | 自定义镜像表现 | 官方镜像表现 | 根本原因 | 修复建议 | 影响程度 |
| ---- | -------- | ------ | -------------- | ------------ | -------- | -------- | -------- |
| 1 | U-Boot | SPI Flash 探测失败 | `Loading Environment from SPI Flash... Invalid bus 0 (err=-19)`<br>`Flash: 0 Bytes` | 成功识别 `w25q128` (16 MiB)，仅提示 `bad CRC` | 自定义 U-Boot 未适配 ACZ820 板卡的 `w25q128` SPI Flash 驱动，SPI 总线/片选配置错误 | 复用官方 U-Boot 中 SPI Flash 驱动配置，添加 `w25q128` 设备支持，修正 SPI0 总线与 CS0 片选参数 | 高 |
| 2 | U-Boot | 以太网 PHY 地址未获取 | `phyaddr -1`，仅识别 eth0 | eth0 `phyaddr 1`、eth1 `phyaddr 5`，双网口均识别 | 自定义 U-Boot/设备树未配置 ACZ820 板卡双网口 PHY 物理地址，无 eth1 节点配置 | 设备树中添加双网口 `phy-handle` 节点，配置 PHY 地址 1（eth0）、5（eth1），U-Boot 中设置 `phyaddr` 环境变量 | 中 |
| 3 | U-Boot | 板卡型号未识别 | 仅显示 `Zynq 7z020`，无具体板卡信息 | 明确识别 `Model: ACZ820 ZYNQ Development Board` | 自定义设备树缺失 `model` 与 `compatible` 节点，未匹配 ACZ820 板卡配置 | 设备树中添加板卡标识节点：`model = "ACZ820 ZYNQ Development Board"`；`compatible = "xlnx,zynq-7000"` | 中 |
| 4 | U-Boot | 环境变量无法保存 | 提示 `using default environment`，无法读写 SPI Flash | 可正常擦写 SPI Flash，仅 CRC 校验异常不影响功能 | 同 SPI Flash 驱动适配失败，U-Boot 无法操作 Flash 存储环境变量 | 修复 SPI Flash 驱动后，执行 `saveenv` 保存 U-Boot 环境变量 | 中 |
| 5 | Linux 内核 | VDMA 初始化失败 | `xilinx-vdma 43000000.dma: unable to request IRQ 0`<br>`device has no channels!` | VDMA 成功 probe，初始化 800x480 帧缓冲：`Xilinx framebuffer initialized` | 1. 自定义设备树 VDMA 中断号配置错误（非 ACZ820 实际中断）；2. 未加载 ACZ820 官方 PL 比特流；3. VDMA 通道/帧缓冲参数缺失 | 1. 复用官方设备树 VDMA 节点配置（中断号、通道数、帧参数）；2. 启动时加载官方 `system_wrapper` PL 比特流；3. 确保内核开启 Xilinx VDMA 驱动 | 高 |
| 6 | Linux 内核 | RTC 实时时钟未识别 | `hctosys: unable to open rtc device (rtc0)`，无 RTC 相关日志 | 成功识别 `rtc-pcf8563 2-0051`，注册为 `rtc0` 并同步系统时间 | 自定义设备树缺失 I2C2 节点及 `pcf8563` RTC 子节点，未匹配 ACZ820 RTC 硬件地址（0x51） | 复用官方设备树 I2C2 与 RTC 节点配置，内核开启 `rtc-pcf8563` 驱动 | 高 |
| 7 | Linux 内核 | SPI Flash 无 MTD 分区 | 内核无任何 SPI Flash 识别日志 | 识别 `w25q128`，创建 4 个 MTD 分区（boot/bootenv/kernel/spare） | 自定义设备树缺失 SPI0 及 `spi-nor` 子节点，内核无法识别 Flash 并分区 | 复用官方设备树 SPI Flash 分区配置，内核开启 SPI Nor Flash 与 MTD 分区驱动 | 中 |
| 8 | Linux 内核 | 内核启动参数错误 | `root=/dev/ram0 rw`，基于内存临时根文件系统启动 | `root=/dev/mmcblk0p2 rw rootwait`，直接挂载 SD 卡 ext4 根分区 | 自定义镜像使用 initramfs 临时根文件系统，未配置 SD 卡根分区挂载，无法加载外设驱动 | 修改内核命令行，替换为官方参数：`console=ttyPS0,115200 earlyprintk root=/dev/mmcblk0p2 rw rootwait` | 高 |
| 9 | Linux 内核 | 外设节点缺失 | 无声卡、触摸屏、双 I2C、USB 等外设识别日志 | 成功加载 ES8388 声卡、Goodix 触摸屏、双 I2C、USB2.0 等全量外设驱动 | 自定义设备树未适配 ACZ820 板卡外设硬件节点，内核无对应驱动匹配对象 | 完整复用官方设备树所有外设节点（I2C、音频、触摸屏、USB 等），内核开启对应外设驱动 | 高 |
| 10 | 系统初始化 | RTC 设备文件缺失 | `hwclock: can't open '/dev/misc/rtc': No such file or directory` | 无 RTC 错误，`hwclock` 可正常访问 `/dev/rtc0` | 内核未识别 RTC 硬件，未创建 RTC 设备文件，与内核阶段 RTC 未识别同源 | 修复内核 RTC 识别问题后，自动生成 RTC 设备文件 | 高 |
| 11 | 系统初始化 | SD 卡文件系统警告 | `FAT-fs (mmcblk0p1): Volume was not properly unmounted` | 出现相同警告（通用问题，非镜像适配故障） | SD 卡未正常关机/拔卡，FAT32 分区文件系统异常 | 1. PetaLinux 根文件系统添加 `dosfstools` 包，执行 `fsck.vfat /dev/mmcblk0p1 -y` 修复；2. 正常关机避免异常断电 | 低 |
| 12 | 系统初始化 | 外设驱动未加载 | 仅启动基础系统，无任何外设驱动加载日志 | 成功加载声卡、触摸屏、网口、USB 等全量外设驱动，SSH/网络正常 | 设备树外设节点缺失 + 启动参数错误，系统无法识别并加载外设驱动 | 修复设备树与内核启动参数后，系统自动加载对应驱动 | 高 |